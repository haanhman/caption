{"3":{"dur":0,"text":"WESTON HUTCHINS: Hello?"},"4":{"dur":1,"text":"Hey, everyone."},"5":{"dur":1,"text":"I was really hoping\nwe were going"},"7":{"dur":1,"text":"to run into Justin\nBieber soundtrack."},"9":{"dur":1,"text":"They had some great\nmusic playing."},"11":{"dur":1,"text":"I was hoping we were going\nto break through a wall"},"12":{"dur":1,"text":"or something, but you know."},"13":{"dur":2,"text":"MANDY WAITE: Yeah,\nkeep the music playing."},"15":{"dur":1,"text":"I was enjoying that."},"16":{"dur":1,"text":"WESTON HUTCHINS:\nWelcome, everyone."},"18":{"dur":3,"text":"We have the dubious 1:00 PM\nafter lunch hour session."},"22":{"dur":1,"text":"We hope that you're\ngoing to be as"},"23":{"dur":2,"text":"excited for this\npresentation as we are."},"25":{"dur":3,"text":"The title of this is, \"Making\nYour Cloud Service Google"},"28":{"dur":0,"text":"Fast.\""},"29":{"dur":1,"text":"Some quick intros."},"30":{"dur":1,"text":"My name is Weston Hutchins."},"32":{"dur":3,"text":"I am a product manager on the\nGoogle Cloud Platform Team."},"35":{"dur":1,"text":"MANDY WAITE: My\nname is Mandy Waite."},"36":{"dur":2,"text":"I'm a developer advocate for\nthe Google Cloud platform."},"38":{"dur":2,"text":"WESTON HUTCHINS: She's my\nDev rock star for today."},"41":{"dur":4,"text":"And today's talk, it's really\nhard to talk about a topic"},"45":{"dur":2,"text":"as deep as performance\nin 30 minutes,"},"48":{"dur":2,"text":"so Mandy and I have cherry\npicked a few tips and tricks."},"50":{"dur":2,"text":"We're going to show you guys\nsome demos on top of Google"},"52":{"dur":3,"text":"Cloud Platform and how\nwe can make your app as"},"56":{"dur":2,"text":"fast as possible leveraging\nthe infrastructure we"},"58":{"dur":1,"text":"use at Google."},"59":{"dur":2,"text":"So we've broken down\nthis into four topics."},"62":{"dur":1,"text":"The first is I'm\ngoing to tell you"},"63":{"dur":2,"text":"a little bit about\nwhy fast matters."},"65":{"dur":2,"text":"Then Mandy's going to take over\nand tell you how we think about"},"68":{"dur":2,"text":"fast inside Google, how we\nleverage the infrastructure"},"71":{"dur":2,"text":"to build our world\nclass apps today."},"73":{"dur":1,"text":"Then the meat of\nthe discussion is"},"75":{"dur":2,"text":"going to be around two topics."},"77":{"dur":1,"text":"One of them is measuring\nfast, and how you"},"79":{"dur":1,"text":"should think about\ncorrectly measuring"},"81":{"dur":1,"text":"the performance of\nyour application."},"82":{"dur":2,"text":"And then Mandy is going to\ntake over and tell you guys how"},"85":{"dur":4,"text":"to scale out and scale fast so\nyou guys can be the next secret"},"89":{"dur":3,"text":"app that has 1,000x growth in\nyour first month of use once"},"93":{"dur":3,"text":"you reach the front\npage of Hacker News."},"97":{"dur":1,"text":"So why fast matters."},"98":{"dur":2,"text":"You might be thinking,\nduh, of course it matters,"},"101":{"dur":2,"text":"but I always like to throw\nout some fun facts just"},"103":{"dur":3,"text":"to talk a little bit about\nwhat the impact of performance"},"106":{"dur":2,"text":"can have on your users."},"109":{"dur":2,"text":"There was a study done a little\nwhile ago that Google actually"},"111":{"dur":4,"text":"went out and intentionally\ninduced a server side lag delay"},"116":{"dur":2,"text":"for every result that was coming\ninto the Google search page."},"118":{"dur":1,"text":"And they wanted to\nmeasure the behavior"},"120":{"dur":3,"text":"over a period of three weeks of\nhow often users were searching"},"123":{"dur":2,"text":"with various amounts\nof lag built in."},"126":{"dur":1,"text":"And what they found\nwas pretty interesting."},"131":{"dur":3,"text":"If you just increase the amount\nof lag by 400 milliseconds,"},"134":{"dur":3,"text":"it would reduce the amount\nof searches by 0.6%."},"138":{"dur":2,"text":"And when you're talking\nat Google scale,"},"140":{"dur":1,"text":"that's actually a huge number."},"141":{"dur":2,"text":"It ended up being about\neight billion searches a day"},"144":{"dur":2,"text":"at the time this study was run."},"146":{"dur":2,"text":"Even more so, this\nstudy also figured out"},"148":{"dur":2,"text":"that users are impatient,\nand you guys probably"},"151":{"dur":2,"text":"don't need me to\nremind you about that."},"154":{"dur":2,"text":"But they found that\none in every four users"},"156":{"dur":1,"text":"will abandon a web\npage if it takes"},"157":{"dur":1,"text":"more than four seconds to load."},"159":{"dur":2,"text":"And given the competitive\nnature of performance nowadays,"},"162":{"dur":1,"text":"I can only imagine\nthat this number"},"163":{"dur":2,"text":"is likely to decrease over time."},"166":{"dur":2,"text":"Mobile apps are also\nimportant as well."},"168":{"dur":2,"text":"It's not just websites that we\nhave to start thinking about."},"171":{"dur":2,"text":"There was a study that was\nreleased just this last week"},"173":{"dur":2,"text":"by App Dynamics, which is a\nleading performance monitoring"},"176":{"dur":1,"text":"solution out there."},"177":{"dur":2,"text":"What they found when they\nsurveyed a bunch of users"},"179":{"dur":4,"text":"was that performance was the\nnumber one top frustration when"},"183":{"dur":2,"text":"using mobile apps and websites."},"186":{"dur":3,"text":"86% of users deleted\nor uninstalled"},"189":{"dur":2,"text":"at least one mobile\napp because of problems"},"191":{"dur":2,"text":"with application performance."},"194":{"dur":1,"text":"Now, there is a\nsilver lining there."},"195":{"dur":2,"text":"They also found\nout that when users"},"198":{"dur":2,"text":"are happy with your\nperformance, they're"},"200":{"dur":1,"text":"going to spend more money."},"201":{"dur":1,"text":"30% of users said they\nwould spend more money"},"203":{"dur":1,"text":"with an application\nthat had greater"},"205":{"dur":1,"text":"performance over\nits competitors."},"206":{"dur":2,"text":"So there is real incentive\nhere for you guys"},"208":{"dur":1,"text":"to spend the money,\nspend the time"},"210":{"dur":2,"text":"speeding up your application\nand making it fast"},"212":{"dur":1,"text":"for your end users."},"213":{"dur":2,"text":"And with that, I'm going\nto hand it over to Mandy,"},"215":{"dur":2,"text":"who's going to talk about\nbuilding a culture of fast"},"217":{"dur":0,"text":"at Google."},"218":{"dur":1,"text":"MANDY WAITE: Thank you, Wes."},"220":{"dur":2,"text":"So fast is at the core\nof pretty much everything"},"222":{"dur":1,"text":"that we do at Google."},"224":{"dur":2,"text":"Well, nearly everything."},"226":{"dur":1,"text":"And users of our\nproducts and services"},"228":{"dur":4,"text":"are used to experiencing a\nconsistently fast performance"},"232":{"dur":1,"text":"from all of our\nproducts and services."},"237":{"dur":2,"text":"You can offer that same\nexperience to your users"},"239":{"dur":2,"text":"by using Google Cloud\nPlatform because Google Cloud"},"242":{"dur":4,"text":"Platform runs on the very same\ninfrastructure as services"},"246":{"dur":2,"text":"such as Gmail, Google\nsearch, YouTube,"},"248":{"dur":3,"text":"and all of our other\nproducts and services."},"251":{"dur":2,"text":"So let's talk about some of the\nphilosophies behind the fast"},"254":{"dur":2,"text":"at Google."},"256":{"dur":3,"text":"In order to meet the\ntraffic demand of modern day"},"260":{"dur":2,"text":"applications, you need\nthe ability to scale fast."},"263":{"dur":1,"text":"And scale fast is\nsomething that we're"},"264":{"dur":1,"text":"going to talk about\nin the last section,"},"266":{"dur":2,"text":"as Wes has already mentioned."},"269":{"dur":3,"text":"And App Engine, our platform\nas a service offering,"},"272":{"dur":1,"text":"which we'll also\ntalk about shortly,"},"274":{"dur":4,"text":"that epitomizes the notion and\nthe principle of scale fast."},"278":{"dur":2,"text":"So we have an example\nof that coming up soon."},"281":{"dur":1,"text":"The ability to\nmeasure fast allows"},"283":{"dur":2,"text":"you to gain insight\nand understanding"},"285":{"dur":3,"text":"of the very complex nature of\nmodern day applications running"},"288":{"dur":1,"text":"in the cloud."},"290":{"dur":2,"text":"And Wes is going to\ntalk to you very shortly"},"292":{"dur":4,"text":"about some specific\nexamples around latency,"},"297":{"dur":1,"text":"and also introduce\nyou to some tools"},"298":{"dur":2,"text":"that we're going to be\nmaking available to users"},"301":{"dur":2,"text":"of the Google Cloud Platform."},"303":{"dur":2,"text":"Then there's the ability\nto innovate fast."},"306":{"dur":3,"text":"This has really been\ncore to our ability"},"309":{"dur":1,"text":"to actually keep\nahead of the game when"},"311":{"dur":6,"text":"it comes to handling, as you can\npretty much imagine, handling"},"318":{"dur":2,"text":"the massive amounts\nof traffic demand"},"320":{"dur":2,"text":"that we have on all of\nour products and services,"},"322":{"dur":2,"text":"and not just on the products\nand services themselves,"},"325":{"dur":2,"text":"but also on the\ninfrastructure that runs them."},"327":{"dur":2,"text":"So we've innovated rapidly\nover the last 15 years,"},"329":{"dur":4,"text":"and this is a timeline of some\nof the things we've introduced,"},"334":{"dur":1,"text":"white papers and such."},"336":{"dur":4,"text":"BigTable is our massively\nscalable, no SWL data store,"},"340":{"dur":4,"text":"and many of our services\nuse BigTable directly."},"345":{"dur":3,"text":"And in fact, App Engine itself\nwas built around BigTable."},"349":{"dur":1,"text":"It was actually\nbuilt around BigTable"},"350":{"dur":1,"text":"to use it specifically."},"352":{"dur":5,"text":"So users of App Engine had\ndirect access to BigTable"},"357":{"dur":4,"text":"as the App Engine data store."},"361":{"dur":1,"text":"That data store\nhas now been made"},"362":{"dur":1,"text":"available to users\nof the cloud platform"},"364":{"dur":2,"text":"directly, from anywhere,\nany user from anywhere"},"367":{"dur":3,"text":"from any application, as\nthe Google Cloud Data Store."},"370":{"dur":0,"text":"Then there's Dremel."},"371":{"dur":2,"text":"Dremel is an analysis\ntool that allows"},"373":{"dur":3,"text":"you to run interactive queries\nacross massive data sets."},"377":{"dur":2,"text":"We're talking about terabytes\nhere, billions and billions"},"379":{"dur":1,"text":"of rows of data."},"380":{"dur":2,"text":"And to get results back in\nseconds, not minutes or hours,"},"383":{"dur":2,"text":"as you would do\nwith a Map Reduce."},"386":{"dur":3,"text":"Dremel is available externally\nby the Google Cloud Platform"},"390":{"dur":2,"text":"as a BigQuery service."},"392":{"dur":0,"text":"Then there's Colossus."},"393":{"dur":2,"text":"Colossus is our second\ngeneration file system,"},"396":{"dur":3,"text":"and many of our data services\nare built on top of Colossus."},"399":{"dur":2,"text":"Colossus has been made\navailable to Cloud Platform"},"402":{"dur":3,"text":"users for many years now\nas Google Cloud Storage."},"406":{"dur":2,"text":"Then there's innovation at\nthe infrastructure layer,"},"409":{"dur":2,"text":"and we're going to talk\nabout Andromeda shortly."},"412":{"dur":1,"text":"So we have scale fast,\nwe have measure fast,"},"413":{"dur":2,"text":"and we have the key\nof innovate fast."},"415":{"dur":3,"text":"All of these things make to a\nwonderful Google Cloud Platform"},"419":{"dur":2,"text":"experience when you use it."},"421":{"dur":2,"text":"Not only do you get all of\nthese when you use Google Cloud"},"424":{"dur":3,"text":"Platform, but you also\nget fast connectivity"},"427":{"dur":2,"text":"to the rest of Google\nat no extra cost."},"430":{"dur":4,"text":"So if you want to consume Google\nsearch results, YouTube videos,"},"435":{"dur":4,"text":"maps data, finance data, you\ncan do so at no additional cost."},"440":{"dur":1,"text":"If you were using\nanother cloud provider,"},"441":{"dur":2,"text":"you would probably have to\npay some additional charges"},"444":{"dur":1,"text":"in order to get that\ndata into the cloud."},"448":{"dur":5,"text":"So I want to talk about how\nsome of the changes that we've"},"453":{"dur":2,"text":"made to our infrastructure will\nbenefit Cloud Platform users,"},"456":{"dur":3,"text":"and I'm going to do this\nin the context of a feature"},"460":{"dur":2,"text":"of our network infrastructure,\na network virtualization"},"462":{"dur":1,"text":"that I called Andromeda."},"464":{"dur":4,"text":"And Andromeda provides all\nof our virtualization needs."},"468":{"dur":4,"text":"So Andromeda is our\nSDN-based, Software Defined"},"473":{"dur":3,"text":"Networking-based network\nbackbone infrastructure."},"477":{"dur":1,"text":"It provides many\nbenefits to us in terms"},"479":{"dur":3,"text":"of quality of service, fault\ntolerance, and lower latency."},"482":{"dur":2,"text":"But it also provides all of\nour virtualization services,"},"485":{"dur":2,"text":"and that shows up in the form\nof virtual networks for Google"},"488":{"dur":1,"text":"Cloud Platform users."},"490":{"dur":2,"text":"Now, Andromeda was not built\nas a Google Cloud Platform"},"493":{"dur":1,"text":"product."},"494":{"dur":1,"text":"It was built\nspecifically to address"},"495":{"dur":2,"text":"the needs of our own\ninternal infrastructure."},"498":{"dur":1,"text":"But because Google\nCloud Platform"},"500":{"dur":1,"text":"runs on that same\ninfrastructure,"},"501":{"dur":1,"text":"it gets the same\nbenefits when it"},"503":{"dur":3,"text":"comes to high performance,\nsecurity, isolation,"},"506":{"dur":2,"text":"and availability."},"508":{"dur":3,"text":"So we built Andromeda\nreally to address the ever"},"511":{"dur":2,"text":"increasing demands of moving\ntraffic between storage"},"514":{"dur":2,"text":"and compute, something\nthat traditional network"},"516":{"dur":4,"text":"infrastructure really\nwasn't able to keep up with."},"521":{"dur":1,"text":"So as you can imagine,\nAndromeda is also"},"523":{"dur":2,"text":"going to give us\nbetter throughput."},"525":{"dur":2,"text":"So we have this graph here,\nprobably a bit of an eye chart"},"528":{"dur":2,"text":"for some of you guys."},"530":{"dur":1,"text":"On the y-axis, we have\nrelative performance,"},"532":{"dur":1,"text":"where higher is better."},"533":{"dur":3,"text":"And on the bottom, we\nhave compute engine"},"537":{"dur":1,"text":"virtual machine instance times."},"539":{"dur":2,"text":"Standard is the standard\nmemory configuration,"},"542":{"dur":2,"text":"and we have one, two,\nfour, and eight cores."},"544":{"dur":2,"text":"So these are bigger\nmachines as we go along"},"547":{"dur":2,"text":"to the right of the x-axis."},"550":{"dur":2,"text":"The blue bars represent\nthe average performance,"},"552":{"dur":2,"text":"the average\nthroughput, for what we"},"555":{"dur":2,"text":"had before Andromeda, the\nnon-Andromeda average."},"558":{"dur":2,"text":"As you can see, this is\nfairly static across all"},"560":{"dur":1,"text":"those machines."},"562":{"dur":1,"text":"The red bar represents\nAndromeda average,"},"564":{"dur":1,"text":"the average we see\nwith Andromeda."},"565":{"dur":2,"text":"As you can see, with the\nsmaller instance, the one core"},"568":{"dur":4,"text":"instance, we get almost double,\n2x throughput performance"},"573":{"dur":2,"text":"on that particular time."},"575":{"dur":1,"text":"When it comes to the\neight core instance,"},"576":{"dur":6,"text":"we get roughly 4x improvement in\nthroughput on single stream TCP"},"583":{"dur":1,"text":"connections."},"584":{"dur":3,"text":"So this makes these larger\ninstances perfectly suited"},"588":{"dur":2,"text":"for network IO\nintensive workloads,"},"590":{"dur":4,"text":"such as maybe Hadoop, HPL,\nany kind of application"},"595":{"dur":2,"text":"that is extremely\nsensitive to latency."},"601":{"dur":1,"text":"Just to mention\nas well, Andromeda"},"603":{"dur":1,"text":"is our network infrastructure."},"604":{"dur":1,"text":"It's available in\nall of our zones"},"606":{"dur":2,"text":"on Compute Engine is\nall of our regions."},"611":{"dur":2,"text":"And on the subject\nof latency-- it"},"614":{"dur":1,"text":"was going to be the\nsubject of latency--"},"615":{"dur":1,"text":"I'm going to hand\nyou over to Wes,"},"617":{"dur":2,"text":"who's going to talk to\nyou about measuring fast."},"619":{"dur":1,"text":"WESTON HUTCHINS: Thanks, Mandy."},"621":{"dur":2,"text":"So I wanted to spend a little\nbit of time talking around what"},"624":{"dur":1,"text":"it means to measure\nan application,"},"625":{"dur":1,"text":"because you guys can\nmake all the performance"},"627":{"dur":1,"text":"improvements in the\nworld, but if you"},"628":{"dur":2,"text":"don't know how they're\nimpacting your application,"},"630":{"dur":2,"text":"you may be doing something\nbad under the covers"},"633":{"dur":2,"text":"that you need to know about."},"635":{"dur":5,"text":"So normally, when I ask a web\ndeveloper, I say, hey John,"},"641":{"dur":1,"text":"can you go tell\nme the performance"},"642":{"dur":2,"text":"of this particular web\npage or application home"},"645":{"dur":1,"text":"page loading screen\nthat's coming up?"},"646":{"dur":2,"text":"The first number they almost\nalways come back with,"},"649":{"dur":1,"text":"which is the easiest\nthing to report,"},"650":{"dur":1,"text":"is average response time."},"652":{"dur":3,"text":"A lot of monitoring\nsolutions report this to you."},"655":{"dur":2,"text":"But the thing I want to point\nout is that this may look good."},"658":{"dur":2,"text":"200 milliseconds may\nnot seem that bad,"},"660":{"dur":1,"text":"but that's only average."},"662":{"dur":2,"text":"How do I know if 10%,\n20% of my customers"},"665":{"dur":2,"text":"are seeing loading times of\ngreater than four seconds,"},"668":{"dur":3,"text":"and then there's a lot of people\nseeing really fast requests?"},"671":{"dur":3,"text":"And average response\ntime is misleading."},"674":{"dur":1,"text":"The real point I wanted\nto try to make here"},"676":{"dur":3,"text":"is that anytime you\nreport an average,"},"679":{"dur":2,"text":"it works well when\nyou have a model that"},"682":{"dur":1,"text":"follows a normal\ndistribution curve."},"684":{"dur":2,"text":"When you see things where\nit's like a few requests that"},"686":{"dur":2,"text":"are very fast, most of them\nin the middle, and then a few"},"688":{"dur":1,"text":"tailing off at the\nend, but the problem"},"690":{"dur":2,"text":"is that most applications\ndon't behave like this."},"693":{"dur":4,"text":"In fact, this is actually a more\ntypical agency analysis curve"},"697":{"dur":2,"text":"that you would see as\npart of your web app"},"699":{"dur":2,"text":"or mobile application."},"701":{"dur":2,"text":"And the reason is this\nbehaves a little bit more"},"703":{"dur":2,"text":"like a step function, and it\nactually makes a lot more sense"},"706":{"dur":3,"text":"when you think about how an\napp is architected and built."},"709":{"dur":1,"text":"At the very beginning\nof the curve,"},"711":{"dur":1,"text":"you see most of the requests."},"712":{"dur":2,"text":"This is a good thing, and this\nis because most modern web"},"715":{"dur":2,"text":"applications and apps\nhave some form of caching."},"718":{"dur":1,"text":"So users go and hit\nyour web server,"},"720":{"dur":2,"text":"the cache serves the request,\ngets the data locally,"},"722":{"dur":2,"text":"and is able to send it back to\nthe customer really quickly."},"725":{"dur":2,"text":"But then what happens when\nyou have a cache miss?"},"728":{"dur":2,"text":"Well, that's when things\ntake a little bit longer."},"730":{"dur":2,"text":"And so if most of the users are\nhitting the cache, only a few"},"733":{"dur":1,"text":"of them are missing\nit, and this is"},"734":{"dur":2,"text":"where you start to see\nthe decrease in the number"},"736":{"dur":2,"text":"of people that experience\nlonger latency."},"739":{"dur":1,"text":"So as I said, it behaves\na little bit more"},"740":{"dur":2,"text":"like a step function."},"742":{"dur":2,"text":"Finally, at the end,\nyou start seeing things"},"745":{"dur":2,"text":"that we call the long tail."},"747":{"dur":2,"text":"This is where you need to\nstart really paying attention"},"750":{"dur":1,"text":"to some of the stuff\nthat's going on."},"752":{"dur":2,"text":"This is the problematic\nareas that you may see,"},"754":{"dur":1,"text":"specifically this guy."},"756":{"dur":2,"text":"If this bump right\nhere starts to spike,"},"758":{"dur":2,"text":"it's usually indicative\nof a problem."},"761":{"dur":2,"text":"It could be your servers\nare overloaded with traffic"},"763":{"dur":1,"text":"and they're starting to fail."},"765":{"dur":2,"text":"It could be a third party\nAPI that's timing out."},"767":{"dur":1,"text":"It really could just\nbe a programming bug."},"769":{"dur":4,"text":"We see a lot of examples where\nsome user comments end up"},"773":{"dur":2,"text":"scaling out and causing\nreally slow response"},"776":{"dur":2,"text":"times for a number of users."},"778":{"dur":2,"text":"Oftentimes, it could be a\nvariety of these things,"},"781":{"dur":3,"text":"but you really want to start\npaying attention to the tailer."},"784":{"dur":2,"text":"Googler Jeff Dean\nsays this best."},"786":{"dur":1,"text":"He goes, \"Even if your\napplication appears"},"788":{"dur":2,"text":"to be performing fast,\nalways be aware of the end"},"791":{"dur":1,"text":"to end spectrum."},"792":{"dur":1,"text":"Don't just look at average."},"793":{"dur":1,"text":"Don't even look at\n50th percentile."},"795":{"dur":4,"text":"Make sure that your long latency\ntails are performing well.\""},"799":{"dur":2,"text":"So if averages aren't the\nanswer, what is the answer?"},"802":{"dur":2,"text":"Typically, when we\ntalk about performance,"},"804":{"dur":3,"text":"I love it when people\ntell me percentiles"},"808":{"dur":1,"text":"rather than averages."},"809":{"dur":2,"text":"And to give a really\nquick, simple example,"},"812":{"dur":2,"text":"imagine my application got\n10 requests that were served."},"814":{"dur":2,"text":"Notice that the average of\nthis is 102 milliseconds,"},"817":{"dur":1,"text":"but it actually\ndoesn't say anything"},"819":{"dur":2,"text":"about how many users are\nseeing average response"},"822":{"dur":2,"text":"times of 102 milliseconds."},"824":{"dur":2,"text":"And if I go and take the\n50th percentile of this,"},"827":{"dur":2,"text":"I can then say, oh,\nhalf of my customers"},"830":{"dur":2,"text":"are experiencing latency\n50 milliseconds or greater."},"832":{"dur":1,"text":"And this gives me\nmuch more confidence"},"834":{"dur":3,"text":"in the range of users that are\nseeing good and bad performance"},"838":{"dur":2,"text":"on my application."},"840":{"dur":1,"text":"So quiz time."},"842":{"dur":2,"text":"If I was to show you guys\na quick little graph of two"},"844":{"dur":3,"text":"applications that have a latency\ncurve that looks like this,"},"848":{"dur":2,"text":"which do you think is better?"},"851":{"dur":2,"text":"Here two, here one, here\na little bit of both."},"854":{"dur":1,"text":"You're probably\nsitting there saying,"},"855":{"dur":2,"text":"you just told us that averages\naren't the right thing,"},"857":{"dur":3,"text":"so of course, the answer is\nit depends, and that's true."},"861":{"dur":2,"text":"In this particular example,\nthis is actually real world data"},"863":{"dur":2,"text":"that we took from two apps\nthat we were running internally"},"866":{"dur":2,"text":"And we found that even\nthough the average of app two"},"869":{"dur":3,"text":"was a little slower, the 95th\npercentile was further in."},"873":{"dur":2,"text":"So we got really reliable,\npredictable, consistent"},"875":{"dur":4,"text":"performance, and it was under\nthat four second magic time."},"880":{"dur":1,"text":"App one had some\nattrition rate from people"},"882":{"dur":2,"text":"that didn't want to wait\nfor these long requests."},"884":{"dur":2,"text":"So really, the whole\npoint of this slide"},"887":{"dur":3,"text":"is to start thinking about\nthe range of performance"},"890":{"dur":2,"text":"across your\napplication, and also"},"892":{"dur":3,"text":"realize that good\nperformance engineers to try"},"896":{"dur":1,"text":"to bring forward the bars."},"897":{"dur":2,"text":"They try to move these\nbars a little bit left"},"899":{"dur":1,"text":"in terms of the\npercentile graphs."},"900":{"dur":3,"text":"But any change that you make\ncan have an adverse affect"},"904":{"dur":2,"text":"on the other percentiles,\nso always keep that in mind."},"907":{"dur":2,"text":"You might make something better\nfor the 50th percentile which"},"910":{"dur":1,"text":"will impact the 95th percentile."},"911":{"dur":1,"text":"And those are just\nperformance trade offs"},"913":{"dur":1,"text":"that you're going to\nhave to figure out"},"915":{"dur":3,"text":"what the right solution\nis for your application."},"918":{"dur":2,"text":"So I'm going to come over\nhere and give you guys"},"921":{"dur":1,"text":"a quick little demo."},"923":{"dur":2,"text":"You saw some of this\nin the keynote today,"},"925":{"dur":3,"text":"and I just wanted to show you\nin a little bit more depth what"},"928":{"dur":2,"text":"was going on."},"930":{"dur":3,"text":"We recently announced a\nproduct called Cloud Trace,"},"934":{"dur":1,"text":"and I want to show\nyou how that works."},"935":{"dur":2,"text":"This is a tool designed to help\nyou debug long latency tail"},"938":{"dur":1,"text":"apps."},"939":{"dur":2,"text":"So I've loaded up\nthe Walk Share app,"},"942":{"dur":2,"text":"and let me exit out\nof the comment here."},"944":{"dur":2,"text":"It's a beautiful app that\nsays, this is where I walk."},"947":{"dur":1,"text":"Look how peaceful that looks."},"956":{"dur":2,"text":"Thank you, Mandy."},"958":{"dur":2,"text":"And it allows you to go\nand comment and figure out,"},"960":{"dur":2,"text":"OK, this is a nice walk\nor it's not a nice walk,"},"963":{"dur":1,"text":"or I've done better than that."},"964":{"dur":2,"text":"So I'm just going to go ahead\nand add a test comment in here."},"970":{"dur":4,"text":"When I hit Post, this is\nexhibiting some pretty long"},"975":{"dur":1,"text":"There was a delay there."},"976":{"dur":0,"text":"It wasn't immediate."},"977":{"dur":1,"text":"And I noticed when\nI was using this"},"979":{"dur":3,"text":"that the more times I\nhad comments on the page,"},"982":{"dur":1,"text":"the more it was lagging."},"984":{"dur":3,"text":"And so Cloud Trace is a tool\ndesigned to help you figure out"},"987":{"dur":1,"text":"what's going on there."},"989":{"dur":1,"text":"Under the Monitoring\ntab, you can"},"991":{"dur":3,"text":"go into the Developers\nconsole and click on Traces,"},"994":{"dur":2,"text":"and this is a tool that allows\nyou to see the requests that"},"997":{"dur":2,"text":"are coming into your\napplication in real time."},"999":{"dur":2,"text":"So if I was to go\nand filter to say,"},"1002":{"dur":2,"text":"let's take a look at\nthings in the last hour,"},"1005":{"dur":3,"text":"and I can even do some searches."},"1010":{"dur":1,"text":"And then I'll sort\nby latency to see"},"1012":{"dur":1,"text":"the slowest latency request."},"1013":{"dur":2,"text":"This was actually\nthe recent request"},"1016":{"dur":1,"text":"that I made in an\nearlier session."},"1018":{"dur":1,"text":"I'll go ahead and pull\nit up because the graph"},"1020":{"dur":0,"text":"should look similar."},"1023":{"dur":2,"text":"But for every single\none of these comments,"},"1026":{"dur":3,"text":"the Cloud Trace tool\ntells me how long"},"1029":{"dur":1,"text":"this particular\nrequest took and then"},"1030":{"dur":2,"text":"gives me a list of the RPCs,\nor Remote Procedure Calls,"},"1033":{"dur":2,"text":"that were made\nduring this request."},"1035":{"dur":1,"text":"So it's really easy\nfor me to pull out"},"1037":{"dur":3,"text":"and say, well, I can\nobviously see the problem."},"1040":{"dur":2,"text":"I'm doing a bunch of\nsynchronous data store calls"},"1043":{"dur":3,"text":"in a loop, which is causing\nit to basically block"},"1046":{"dur":1,"text":"on the number of\ncomments that I have."},"1048":{"dur":2,"text":"In fact, if I even go and click\non some of these other tabs,"},"1050":{"dur":1,"text":"I can see that the\nmajority of my calls"},"1052":{"dur":3,"text":"are all in this data\nstore.get method."},"1056":{"dur":2,"text":"And the fix for this\nis pretty simple."},"1059":{"dur":5,"text":"I ended up pulling\nup some code here."},"1064":{"dur":2,"text":"I'm not going to make the fix,\nbut what I wanted to call out"},"1066":{"dur":1,"text":"was I noticed that everything\nthat I was doing here"},"1068":{"dur":1,"text":"in data store was via\nsynchronous method."},"1070":{"dur":2,"text":"We actually offer Async\ncounterparts to most of these."},"1072":{"dur":1,"text":"So I fixed the\nversion of the app."},"1074":{"dur":2,"text":"I ended up pushing that out\nto production using the Async"},"1077":{"dur":3,"text":"APIs, and when I got was\na very different picture."},"1080":{"dur":1,"text":"You can notice that most\nof my data store calls"},"1082":{"dur":1,"text":"are now parallelized."},"1083":{"dur":2,"text":"I'm doing some puts in\naddition to some gets here."},"1086":{"dur":1,"text":"This greatly sped\nup the overall end"},"1088":{"dur":2,"text":"to end performance\nof my application."},"1090":{"dur":2,"text":"And a few more notes\non Cloud Trace."},"1092":{"dur":3,"text":"Right now, this is a product\nthat's in limited preview."},"1095":{"dur":2,"text":"We're going to support it\nfor App Engine right out"},"1098":{"dur":1,"text":"Zero configuration."},"1100":{"dur":3,"text":"You turn this on, you get these\ntraces for you automatically."},"1103":{"dur":2,"text":"And as we start to roll\nout the life cycle of this,"},"1105":{"dur":1,"text":"we really want to\nextend this across"},"1107":{"dur":2,"text":"not just App Engine but\nCompute Engine as well,"},"1110":{"dur":2,"text":"and give you guys detail\nanalysis on what these RPC"},"1112":{"dur":2,"text":"calls are doing, what code\nline was calling them,"},"1115":{"dur":3,"text":"and really take a deep look\ninto what your service is doing"},"1118":{"dur":1,"text":"for every single request\nthat's coming in."},"1123":{"dur":2,"text":"Now, before I hand\nit back to Mandy,"},"1126":{"dur":3,"text":"I wanted to impart with you guys\na few little tips and tricks"},"1129":{"dur":3,"text":"for how to manage\nlong tail latency."},"1133":{"dur":2,"text":"Tip number one."},"1135":{"dur":3,"text":"Before you do anything, look\nto reduce the number of RPCs"},"1139":{"dur":1,"text":"before optimizing\nyour algorithms."},"1140":{"dur":1,"text":"So many times, I've\ntalked to people"},"1142":{"dur":1,"text":"where the first thing\nthey want to do is go"},"1144":{"dur":1,"text":"and hunt through\nyour code, through"},"1145":{"dur":1,"text":"every single in\nsquared algorithm,"},"1147":{"dur":1,"text":"and try to clean that\nup into some n log"},"1148":{"dur":3,"text":"n or even fancier set of code."},"1151":{"dur":2,"text":"And that's usually\nnot what speeds up"},"1154":{"dur":1,"text":"your application the most."},"1155":{"dur":2,"text":"The number of RPC calls\nevery single request"},"1157":{"dur":1,"text":"makes is usually the\nnumber one contributor"},"1159":{"dur":1,"text":"to slow performance."},"1160":{"dur":3,"text":"And for this particular example,\nthis is a really common thing"},"1163":{"dur":2,"text":"I see where people are making a\nbunch of Memcache or data store"},"1166":{"dur":3,"text":"calls, and they don't\nrealize that you can actually"},"1169":{"dur":1,"text":"batch these together."},"1170":{"dur":2,"text":"Data store provides\nreally nice mechanisms"},"1173":{"dur":2,"text":"for retrieving data\nvia batch operation"},"1176":{"dur":2,"text":"where you're able to pass\nin a set of keys as opposed"},"1178":{"dur":1,"text":"to each one individually."},"1181":{"dur":0,"text":"Tip number two."},"1182":{"dur":4,"text":"Cache read only third\nparty API calls."},"1186":{"dur":2,"text":"The thing to remember is that if\nyou're making a bunch of calls"},"1189":{"dur":4,"text":"off to Facebook, Twitter,\nGoogle Maps, whatever, they have"},"1193":{"dur":1,"text":"the same performance\ncharacteristics"},"1195":{"dur":2,"text":"that your application\nhas as well."},"1197":{"dur":3,"text":"So realize that for every 100\ncalls you make, 99% of them"},"1201":{"dur":2,"text":"are going to be very fast,\nbut there is a chance"},"1203":{"dur":2,"text":"that a few of them are\ngoing to turn very slowly."},"1206":{"dur":1,"text":"They could either time\nout or they could just"},"1207":{"dur":1,"text":"take a long time to\nreturn to you because they"},"1209":{"dur":2,"text":"have the same latency\ncurves just like you do."},"1212":{"dur":2,"text":"Even worse, if you start to\nload a page that chains a bunch"},"1214":{"dur":3,"text":"of these together, say, like\nan account details page that"},"1218":{"dur":2,"text":"wants to show name, address,\nbilling information from all"},"1220":{"dur":2,"text":"these different services,\nyou're increasing the percentage"},"1223":{"dur":1,"text":"chance that one\nof these services"},"1225":{"dur":1,"text":"is going to return slow."},"1226":{"dur":1,"text":"And if your page\nhappens to block"},"1228":{"dur":2,"text":"on showing that\ninformation, well, then you"},"1230":{"dur":1,"text":"end up in a little\nbit of a problem."},"1232":{"dur":5,"text":"So the tip here, when you can,\nif you have some data that"},"1237":{"dur":3,"text":"is not likely to change\nvery often, is read only,"},"1241":{"dur":1,"text":"cache that locally."},"1242":{"dur":1,"text":"Name and address are\nreally good examples"},"1244":{"dur":1,"text":"where you don't\nnecessarily need to make"},"1245":{"dur":1,"text":"API calls for all of that stuff."},"1247":{"dur":1,"text":"Store it locally, make\nthe retrieval faster,"},"1249":{"dur":2,"text":"and try to reduce the number\nof external dependencies"},"1251":{"dur":2,"text":"your application has."},"1254":{"dur":1,"text":"And then the last one."},"1255":{"dur":1,"text":"This is sort of a\nno brainer but I"},"1256":{"dur":2,"text":"like to remind people\nbecause not everyone realizes"},"1259":{"dur":2,"text":"that we have\nasynchronous methods"},"1261":{"dur":4,"text":"for almost every single\none of our outgoing calls"},"1265":{"dur":2,"text":"in App Engine."},"1267":{"dur":2,"text":"The synchronous methods\nhave an Async counterpart."},"1270":{"dur":3,"text":"So really, learn\nthe documentation."},"1273":{"dur":2,"text":"Be aggressive about\nusing the Async."},"1276":{"dur":2,"text":"Put in a pretty\naggressive deadline limit."},"1278":{"dur":1,"text":"You can actually\nspecify how long"},"1280":{"dur":2,"text":"to wait before a particular\nRPC call is returned."},"1283":{"dur":2,"text":"You can be a lot more aggressive\nin sending out a few of those"},"1285":{"dur":2,"text":"just in case one of them\nhappens to return slowly."},"1288":{"dur":2,"text":"And with that, Mandy is\ngoing to talk to you guys"},"1291":{"dur":3,"text":"about, once you have everything\nup and running, scaling"},"1294":{"dur":1,"text":"out fast so that\nyour application can"},"1295":{"dur":1,"text":"handle a lot of load."},"1297":{"dur":1,"text":"MANDY WAITE: Thanks, Wes."},"1298":{"dur":2,"text":"So what do you do when you\nhave to scale for a one"},"1301":{"dur":3,"text":"off global event involving one\nof the biggest social media"},"1304":{"dur":3,"text":"entities on the planet?"},"1307":{"dur":1,"text":"How many of you have\nheard of One Direction?"},"1312":{"dur":4,"text":"How many of you have\nheard of One Direction?"},"1316":{"dur":1,"text":"There wasn't many hands up."},"1317":{"dur":1,"text":"I think most of you are liars."},"1318":{"dur":1,"text":"You've all heard\nof One Direction."},"1320":{"dur":1,"text":"You just won't admit it."},"1321":{"dur":2,"text":"Back in October of last\nyear, we received a request"},"1324":{"dur":3,"text":"from our marketing team\nto assess an agency"},"1327":{"dur":3,"text":"with the development of a second\nscreen application for what"},"1331":{"dur":2,"text":"was known as One Direction Day."},"1333":{"dur":3,"text":"And One Direction Day was a\nseven hour continuous YouTube"},"1337":{"dur":3,"text":"live stream by the boy\nband One Direction."},"1340":{"dur":2,"text":"And we were told in October."},"1343":{"dur":1,"text":"The event was on the\n23rd of November."},"1345":{"dur":2,"text":"It wasn't a huge amount\nof time to get this done."},"1347":{"dur":1,"text":"Also, scale was a\nparticular concern"},"1349":{"dur":3,"text":"because based on previous\nlive streams that they"},"1352":{"dur":2,"text":"had done with the\nband, they estimated"},"1355":{"dur":5,"text":"a potential concurrent usage\nof 650,000 concurrent users."},"1361":{"dur":3,"text":"So because of the two factors,\nthe short amount of time"},"1364":{"dur":2,"text":"involved, and also because\nof the scale involved,"},"1367":{"dur":2,"text":"the agency chose to\nuse Google App Engine."},"1370":{"dur":2,"text":"This is what they\nbuilt, very simply."},"1372":{"dur":3,"text":"The user would connect to\nthe App Engine application"},"1376":{"dur":3,"text":"and would be asked to log\nin using Google+ sign in."},"1380":{"dur":1,"text":"Once they'd logged\nin, they would"},"1382":{"dur":1,"text":"be presented with questions."},"1383":{"dur":3,"text":"New questions would be\navailable every 10 minutes,"},"1387":{"dur":2,"text":"six questions every hour,\n42 questions in total,"},"1389":{"dur":1,"text":"and there's absolutely\nno significance"},"1391":{"dur":2,"text":"in that number, 42."},"1394":{"dur":3,"text":"So they were presented with\nquestions every 10 minutes"},"1397":{"dur":1,"text":"and they would\nanswer the question."},"1399":{"dur":2,"text":"The client side code\nwould return the answer"},"1402":{"dur":2,"text":"to an endpoint, run it\nin the same application."},"1404":{"dur":1,"text":"An endpoint was\ndesigned to handle"},"1406":{"dur":1,"text":"all of our data services."},"1407":{"dur":4,"text":"And that data about any correct\nanswers, only correct answers,"},"1412":{"dur":3,"text":"were stored into mem cache,\nalong with any demographic"},"1415":{"dur":2,"text":"information that we have\nthat the user had allowed us"},"1418":{"dur":3,"text":"to actually gain from\nthe Google+ sign in."},"1421":{"dur":2,"text":"Now, we stored it into\nMemcache, but because this"},"1423":{"dur":1,"text":"was a one off event,\nwe didn't actually"},"1425":{"dur":1,"text":"store it through to\nour back end store."},"1426":{"dur":1,"text":"This wasn't a write\nthrough cache."},"1428":{"dur":2,"text":"This was just stored into cache."},"1430":{"dur":3,"text":"Now, App Engine has a\nshared mem cache service."},"1434":{"dur":1,"text":"The service isn't\ncompletely free."},"1436":{"dur":1,"text":"They're shared across\nall applications"},"1437":{"dur":2,"text":"running on App Engine."},"1439":{"dur":2,"text":"Obviously, that would make\nit a little bit volatile,"},"1442":{"dur":1,"text":"so we have this feature\nas well in App Engine"},"1444":{"dur":3,"text":"called Dedicated Memcache, which\nis what we used for this event."},"1447":{"dur":3,"text":"We reserved about 20\ngigabytes of space"},"1451":{"dur":3,"text":"in Memcache specifically\nfor our application."},"1455":{"dur":1,"text":"So all of the data was\nstored into Memcache,"},"1456":{"dur":1,"text":"and there was another\nendpoint that's"},"1458":{"dur":2,"text":"not shown on the\ndiagram that was used"},"1460":{"dur":2,"text":"by the organizers of the\nevent to query that data that"},"1463":{"dur":1,"text":"was stored in Memcache."},"1465":{"dur":3,"text":"And that allowed them to come\nup with interesting statistics,"},"1468":{"dur":5,"text":"such as 95% of people in\nthe age range 20 to 30"},"1473":{"dur":2,"text":"in Brazil answered the\nlast question correctly."},"1476":{"dur":1,"text":"They could then put\nthat data on the tickers"},"1478":{"dur":4,"text":"at the bottom of the live\nstream and broadcast it live."},"1483":{"dur":3,"text":"After the 42 questions\nhad been delivered,"},"1486":{"dur":1,"text":"we would drain the data."},"1488":{"dur":1,"text":"After the event is\nfinished, the data"},"1489":{"dur":3,"text":"would be drained out Of\nmemcache into Cloud SQL, which"},"1493":{"dur":2,"text":"is our MySQL in\nthe cloud offering."},"1495":{"dur":0,"text":"That's the application."},"1496":{"dur":2,"text":"That's how complicated it\nwas, or not complicated."},"1501":{"dur":3,"text":"So obviously, scale\nwas a big concern,"},"1504":{"dur":3,"text":"and we, in partnership\nwith the agency,"},"1508":{"dur":3,"text":"did lots of load testing\nbefore the event."},"1511":{"dur":2,"text":"After 10,000 queries\nper second-- and queries"},"1514":{"dur":2,"text":"per second that we use\ninternally in Google"},"1516":{"dur":2,"text":"generally equates to\nrequests per second."},"1519":{"dur":4,"text":"And that was great,\n10k queries per second."},"1523":{"dur":3,"text":"The URL of the application\nwas leaked before the event,"},"1527":{"dur":2,"text":"so we were able to see a\nsteady ramp up in traffic."},"1529":{"dur":1,"text":"It was leaked\nthrough social media,"},"1531":{"dur":3,"text":"so that ramp up was\nrelatively exponential,"},"1535":{"dur":1,"text":"but it did allow us to\ntest some assumptions,"},"1537":{"dur":2,"text":"and also to fix a couple of\nissues that we saw with our API"},"1540":{"dur":3,"text":"quota around Google+."},"1543":{"dur":2,"text":"We didn't leak the\nURL, but if I was ever"},"1545":{"dur":1,"text":"going to do this again,\nI would definitely"},"1547":{"dur":4,"text":"leak the URL myself just to make\nthat happen, but it was great."},"1552":{"dur":2,"text":"Then we settled into this\nsteady traffic pattern"},"1555":{"dur":3,"text":"where we saw every five\nminutes a peak of about 600,"},"1558":{"dur":3,"text":"a peak of about 700\nqueries per second."},"1562":{"dur":2,"text":"That's what this\ngraph shows here."},"1565":{"dur":3,"text":"Now, we had to try and avoid\nthe issue where potentially,"},"1568":{"dur":4,"text":"650,000 users would all answer\na question simultaneously."},"1572":{"dur":2,"text":"So the delivery of the\nquestions or the availability"},"1575":{"dur":2,"text":"of questions was staggered\nover a period of time."},"1578":{"dur":1,"text":"That's why we have\ntwo spikes and why"},"1579":{"dur":3,"text":"the spikes are reasonably broad."},"1583":{"dur":3,"text":"So that went on for about four\nhours, and about four hours"},"1586":{"dur":9,"text":"into the event, the\norganizers of the live stream"},"1596":{"dur":4,"text":"decided to announce the\napplication live on the event."},"1600":{"dur":1,"text":"And that gave us\nthis spike here,"},"1602":{"dur":4,"text":"a slightly different\nx-axis here."},"1606":{"dur":2,"text":"We saw a spike of 9,000 QPS."},"1609":{"dur":4,"text":"And later on, we saw a spike of\naround 5,000 or 6,000 as well."},"1613":{"dur":1,"text":"So that was fine."},"1614":{"dur":2,"text":"We'd tested up to 10,000\nqueries per second."},"1617":{"dur":3,"text":"We had capacity to go\nway beyond that as well."},"1620":{"dur":0,"text":"So that was fine."},"1621":{"dur":1,"text":"We had no problems\nwith that at all."},"1623":{"dur":2,"text":"We had no problems with\nthis because App Engine just"},"1625":{"dur":1,"text":"scales inherently."},"1626":{"dur":1,"text":"There's not a huge\namount a developer has"},"1628":{"dur":2,"text":"to do to actually\nscale on App Engine."},"1630":{"dur":1,"text":"Obviously, with an\nevent of this size where"},"1632":{"dur":1,"text":"we have to scale massively\nand rapidly, there"},"1634":{"dur":2,"text":"are certain things we have\nto do within the application"},"1636":{"dur":1,"text":"to make sure it doesn't\nbottleneck or anything"},"1638":{"dur":1,"text":"But generally, if you're\nbuilding on App Engine,"},"1640":{"dur":0,"text":"you'll just scale."},"1641":{"dur":3,"text":"The instances, it's very\nsmall micro virtual machines,"},"1644":{"dur":3,"text":"are spun up very quickly,\ntorn down very quickly."},"1647":{"dur":2,"text":"So you always have what\nyou need when you need it"},"1649":{"dur":2,"text":"but you only pay\nfor what you use."},"1652":{"dur":2,"text":"But how do you scale Compute\nEngine virtual machines?"},"1655":{"dur":1,"text":"So Compute Engine is\nour infrastructure"},"1656":{"dur":2,"text":"as a service offering\nwhere App Engine was"},"1659":{"dur":1,"text":"our platform as a\nservice offering,"},"1661":{"dur":2,"text":"and we're trying to blur the\nlines between infrastructure"},"1663":{"dur":1,"text":"and platform."},"1664":{"dur":2,"text":"So how would you go about\nscaling Compute engine"},"1666":{"dur":1,"text":"virtual machines?"},"1668":{"dur":1,"text":"So you do it this way."},"1669":{"dur":1,"text":"This is something\nthat we announced back"},"1670":{"dur":2,"text":"in March of this year."},"1673":{"dur":3,"text":"We announced Deployment\nManager replica pools,"},"1676":{"dur":1,"text":"another thing called\nresource views,"},"1678":{"dur":2,"text":"which we're not going to\ntalk about too much today."},"1680":{"dur":1,"text":"They're a little bit obscure."},"1681":{"dur":2,"text":"But basically, we like doing\nthings in Google declaratively."},"1684":{"dur":3,"text":"We like creating templates or\nconfig files and building stuff"},"1687":{"dur":2,"text":"from those templates\nand config files."},"1689":{"dur":1,"text":"This is an example template."},"1690":{"dur":1,"text":"It's not really there\nfor you to read,"},"1692":{"dur":2,"text":"but this is an\nexample of a template."},"1694":{"dur":2,"text":"That will be fed into a\nservice called Replica Pool,"},"1697":{"dur":2,"text":"and Replica Pool would\ndo all of the work"},"1699":{"dur":2,"text":"in converting that translate\ninto a deployment, which"},"1702":{"dur":1,"text":"would look something like that."},"1704":{"dur":2,"text":"So this is a group\nof virtual machines."},"1706":{"dur":1,"text":"These are what Chris\n[INAUDIBLE] would"},"1708":{"dur":3,"text":"call a fleet of homogeneous\nvirtual machines,"},"1711":{"dur":1,"text":"and they're all the same."},"1712":{"dur":0,"text":"They're all identical."},"1713":{"dur":1,"text":"They're all built\nfrom this template."},"1715":{"dur":1,"text":"There's no snowflake\nservice here."},"1716":{"dur":1,"text":"And we have a load\nbalancer as well"},"1718":{"dur":1,"text":"configured to\ndistribute the load"},"1719":{"dur":1,"text":"across the pool of\nvirtual machines"},"1721":{"dur":3,"text":"with a single endpoint, a single\nIP address you can connect to."},"1724":{"dur":1,"text":"So for all intents\nand purposes, they"},"1726":{"dur":2,"text":"look like one virtual\nmachine, but there's many."},"1731":{"dur":2,"text":"Replica Pool also offers a\nmonitoring service as well."},"1733":{"dur":2,"text":"So it can monitor the health\nof these virtual machines,"},"1735":{"dur":3,"text":"and if they break, they can\nbring them back up again."},"1739":{"dur":3,"text":"This is all done from an agent\nrunning on the virtual machine."},"1743":{"dur":1,"text":"So that's Replica Pool."},"1744":{"dur":1,"text":"This is a static resource."},"1745":{"dur":1,"text":"We can scale it manually."},"1747":{"dur":1,"text":"We can add replicas."},"1749":{"dur":2,"text":"We can remove replicas and\nsize the pool manually."},"1751":{"dur":4,"text":"But how would we manage auto\nscale in this situation?"},"1756":{"dur":3,"text":"So now we're going to talk about\nsomething called autoscaler."},"1759":{"dur":3,"text":"Autoscaler is already available\nas part of Deployment Manager."},"1762":{"dur":3,"text":"Ultimately, it will be made\navailable as a separate API."},"1765":{"dur":2,"text":"But autoscaler allows\nyou to create a config"},"1768":{"dur":3,"text":"within your template that\nsets up auto scale parameters."},"1771":{"dur":2,"text":"At the moment, the only\nthing we can auto scale on--"},"1774":{"dur":4,"text":"and this will change-- is\naverage CPU utilization"},"1779":{"dur":1,"text":"across the entire pool."},"1780":{"dur":1,"text":"And that's where\nyou'll see there"},"1781":{"dur":2,"text":"where it says Target\nUtilization 0.5."},"1784":{"dur":4,"text":"That's effectively\n50% CPU utilization"},"1789":{"dur":2,"text":"averaged across the entire pool."},"1791":{"dur":3,"text":"Whenever we go above 50%\nutilization on average,"},"1794":{"dur":1,"text":"we'll spin up new instances."},"1796":{"dur":3,"text":"Whenever we go below 50%, if\nwe have too many instances,"},"1799":{"dur":1,"text":"we'll turn them down."},"1800":{"dur":1,"text":"That's how auto scale works."},"1802":{"dur":2,"text":"And now, we're going to\ngive you a demo of that"},"1805":{"dur":1,"text":"actually working."},"1807":{"dur":2,"text":"This is the kind of demo\nyou can spend 30 minutes on."},"1809":{"dur":2,"text":"I'm going to try\nand do it in three."},"1817":{"dur":3,"text":"Can everybody read that?"},"1820":{"dur":2,"text":"Can everybody read it?"},"1822":{"dur":1,"text":"Yeah?"},"1823":{"dur":1,"text":"No no's?"},"1824":{"dur":0,"text":"OK, good."},"1825":{"dur":2,"text":"I should have asked if\nanybody couldn't read it."},"1838":{"dur":1,"text":"So back to my\nslides just briefly,"},"1840":{"dur":1,"text":"I just wanted to set that up."},"1848":{"dur":1,"text":"I'm going to go\nthrough the left hand"},"1850":{"dur":1,"text":"side of what this\ndemo looks like,"},"1851":{"dur":1,"text":"and then I'll go through\nthe right hand side"},"1852":{"dur":1,"text":"once I've kicked it off."},"1853":{"dur":2,"text":"It takes a little\nbit of time to run."},"1856":{"dur":2,"text":"So we're going to be making\nuse of Google Cloud Storage."},"1859":{"dur":1,"text":"Google Cloud Storage\nis an object store."},"1860":{"dur":3,"text":"It's a bucket-based store\nfor unstructured data."},"1864":{"dur":2,"text":"It has a lot of really\nnifty-- sorry, that's"},"1866":{"dur":4,"text":"a British term-- a lot\nof really cool features"},"1871":{"dur":1,"text":"that you can make use of."},"1872":{"dur":2,"text":"One of them, the one we're\ngoing to make use of,"},"1874":{"dur":1,"text":"is called Object Notifications."},"1876":{"dur":1,"text":"So we have these buckets."},"1877":{"dur":2,"text":"We have an input bucket\nand an output bucket."},"1879":{"dur":3,"text":"So what we're going to do here\nis solve a relatively complex"},"1883":{"dur":4,"text":"problem where a user has a\nlarge number of images coming"},"1887":{"dur":3,"text":"from some source that she wants\nto convert into thumbnails,"},"1890":{"dur":1,"text":"and she wants to do\nthis very quickly."},"1892":{"dur":2,"text":"We don't know why she wants\nto do it very quickly,"},"1894":{"dur":1,"text":"but she needs to\ndo it very quickly."},"1895":{"dur":1,"text":"That's the problem we're\ngoing to solve here."},"1897":{"dur":1,"text":"So we have an\ninput bucket, which"},"1899":{"dur":2,"text":"will receive incoming\nimages, and an output bucket,"},"1901":{"dur":2,"text":"which will receive thumbnails."},"1903":{"dur":4,"text":"So having said that, I'm going\nto kick the actual copying"},"1907":{"dur":5,"text":"over of images off\nnow while I talk."},"1913":{"dur":4,"text":"So Cloud Storage has\nthis tool called GS Util,"},"1918":{"dur":3,"text":"and it allows us to copy files\nfrom one bucket to another."},"1921":{"dur":1,"text":"So in this case, I\nhave a bucket that's"},"1923":{"dur":6,"text":"pre-configured with\nexactly 1,111 images, which"},"1929":{"dur":2,"text":"I'm going to copy over from\nthat bucket to another bucket."},"1932":{"dur":1,"text":"So the first thing we\nneed to do here, though,"},"1934":{"dur":3,"text":"is look at what we\nhave to begin with."},"1937":{"dur":2,"text":"So if I go to the developer's\nconsole, which we showed you"},"1939":{"dur":3,"text":"earlier, this is my replica\npool which I created before."},"1943":{"dur":1,"text":"I've actually set\nthis replica pool up"},"1945":{"dur":2,"text":"with a load balancer\nwith one virtual machine,"},"1947":{"dur":3,"text":"and this is the virtual\nmachine, I\/O 14 Demo Y598."},"1951":{"dur":0,"text":"That's what we have."},"1952":{"dur":1,"text":"You can see from the\nspikes in the graph"},"1954":{"dur":3,"text":"that I have been practicing\nthis demo many, many times"},"1957":{"dur":2,"text":"over the last few days,\nwhich is quite fun."},"1960":{"dur":2,"text":"And it's always worked,\nso hopefully today, it's"},"1962":{"dur":2,"text":"going to work as well."},"1965":{"dur":1,"text":"So what else do we have?"},"1967":{"dur":1,"text":"We have Cloud Storage."},"1968":{"dur":2,"text":"If I look at Cloud Storage,\nwe have three buckets."},"1971":{"dur":3,"text":"We have our Images bucket, which\nis where the input images are"},"1975":{"dur":5,"text":"going to come into, and we\nhave the Thumbnails bucket,"},"1981":{"dur":2,"text":"which is where the thumbnails\nwill be written to."},"1983":{"dur":3,"text":"Then we have the\nPayload bucket, and this"},"1987":{"dur":1,"text":"is where all of the images are."},"1988":{"dur":1,"text":"This could be any source."},"1989":{"dur":2,"text":"This could be some source of\nimages, a stream of images,"},"1992":{"dur":1,"text":"a batch of images,\nbut we're basically"},"1994":{"dur":3,"text":"going to copy them over\nfrom one bucket to another."},"1997":{"dur":1,"text":"So GS Util allows us to do that."},"1999":{"dur":2,"text":"It allows us to copy from\none bucket to another."},"2001":{"dur":3,"text":"So we're going to copy from\nAutoscale-IO-Payload all"},"2004":{"dur":4,"text":"of the files into\nAutoscale-IO-Images."},"2009":{"dur":1,"text":"And we're going to\ndo this in parallel."},"2010":{"dur":1,"text":"We're not going to pull\nthe files down and then"},"2012":{"dur":0,"text":"push them back up."},"2013":{"dur":2,"text":"This is going to copy them\nbetween the cloud storage"},"2015":{"dur":3,"text":"buckets directly, internal\nGoogle infrastructure,"},"2019":{"dur":2,"text":"and we're going to\ndo it in parallel."},"2022":{"dur":4,"text":"Because for some reason\nthis always seems to fail,"},"2026":{"dur":2,"text":"I'm going to do this first."},"2028":{"dur":2,"text":"Ulimit minus n 10,000."},"2031":{"dur":3,"text":"That allows me to have\n10,000 file handles."},"2034":{"dur":2,"text":"And for some reason, that\nseem to reset itself every now"},"2036":{"dur":4,"text":"and again, and I\nhave no idea why."},"2040":{"dur":1,"text":"Now we kick off\nthe copy, and that"},"2042":{"dur":3,"text":"will happen in the background\nwhile I continue talking."},"2046":{"dur":1,"text":"Is it more interesting\nto watch this"},"2047":{"dur":2,"text":"or to listen to me talking?"},"2050":{"dur":2,"text":"I'm not sure."},"2053":{"dur":4,"text":"So going back to the\nslides, what we have here is"},"2057":{"dur":1,"text":"object notifications."},"2059":{"dur":2,"text":"Object notifications are\nreally called whenever anything"},"2062":{"dur":2,"text":"is added to the bucket\nor anything is updated"},"2064":{"dur":3,"text":"within the bucket, any object,\na notification will be fired,"},"2068":{"dur":2,"text":"and that notification will\nbe in the form of a URL which"},"2070":{"dur":2,"text":"is being called by\nthe notification."},"2073":{"dur":2,"text":"So with every image\nwe add to the bucket,"},"2076":{"dur":1,"text":"we're going to have\none of these calls"},"2078":{"dur":2,"text":"specifically for\nthat image to a URL,"},"2080":{"dur":1,"text":"which we've registered\nahead of time."},"2082":{"dur":2,"text":"And that URL could be a load\nbalanced pool of replicas,"},"2085":{"dur":2,"text":"a load balanced of\nvirtual machines."},"2087":{"dur":2,"text":"But that gives us no\ncontrol over the way"},"2089":{"dur":2,"text":"in which data flows\ninto the system."},"2092":{"dur":1,"text":"So we're going to use\nsomething in App Engine."},"2094":{"dur":1,"text":"We're going to use an\nApp Engine application"},"2096":{"dur":1,"text":"and something\ncalled Task Queues."},"2097":{"dur":2,"text":"How many of you have\nheard of Task Queues?"},"2099":{"dur":2,"text":"Task Queues are one of the\nbest features of App Engine."},"2102":{"dur":2,"text":"They allow us to actually\ndo work outside of the user"},"2104":{"dur":1,"text":"request."},"2106":{"dur":3,"text":"So the request deadline for\na user request is 60 seconds."},"2109":{"dur":2,"text":"Often, you want to do\nwork outside of that,"},"2111":{"dur":1,"text":"so you'll use a Task Queue"},"2113":{"dur":2,"text":"What you do is you create a\ntask, you put it onto a queue,"},"2115":{"dur":2,"text":"and then you have something\nin App Engine consuming"},"2118":{"dur":4,"text":"those tasks from the queue at\na rate of, by default, five"},"2122":{"dur":2,"text":"every second."},"2124":{"dur":3,"text":"The applications consuming those\ntasks will process the request"},"2128":{"dur":3,"text":"and then create another HTTP\nrequest to our pool of load"},"2132":{"dur":1,"text":"balanced virtual machines."},"2133":{"dur":2,"text":"And this will be distributed\nacross our virtual machines,"},"2136":{"dur":2,"text":"hopefully in a round robin\nstyle, across all of them."},"2138":{"dur":2,"text":"We only have one to begin\nwith, so there's not"},"2141":{"dur":3,"text":"But hopefully, we'll have more\nbefore the end of the demo."},"2144":{"dur":2,"text":"Then we have a process running\non the virtual machines that"},"2147":{"dur":1,"text":"will process the\nimages with Image Magic"},"2149":{"dur":0,"text":"and create a thumbnail."},"2153":{"dur":2,"text":"So we go back to the Developer's\nConsole, look at that."},"2156":{"dur":2,"text":"First thing we want to look\nat is the Thumbnails bucket."},"2159":{"dur":1,"text":"And hopefully when\nI click on this,"},"2160":{"dur":1,"text":"we'll see a whole\nbunch of thumbnails"},"2161":{"dur":1,"text":"which weren't there before."},"2166":{"dur":2,"text":"So these are the thumbnails."},"2168":{"dur":3,"text":"The thumbnails are\na picture of me"},"2172":{"dur":3,"text":"because I'm an egotist\nor something like that."},"2175":{"dur":1,"text":"So we're getting thumbnails."},"2176":{"dur":0,"text":"That's good."},"2177":{"dur":1,"text":"We want to get thumbnails."},"2179":{"dur":1,"text":"What about these virtual\nmachines, though?"},"2181":{"dur":3,"text":"How many do we have?"},"2184":{"dur":1,"text":"We have two currently."},"2185":{"dur":2,"text":"So we've doubled the\nsize of our pool."},"2187":{"dur":2,"text":"We've added another virtual\nmachine to do processing."},"2189":{"dur":5,"text":"So this basically is set up to\na threshold of 0.3, which 30%."},"2194":{"dur":3,"text":"So we're looking for\n30% CPU utilization."},"2198":{"dur":1,"text":"The application running\non the virtual machines"},"2200":{"dur":2,"text":"is a Go application and\nis using Go routines,"},"2202":{"dur":3,"text":"so it can do the request\nprocessing in parallel."},"2205":{"dur":1,"text":"Normally, we get four\nvirtual machines."},"2207":{"dur":1,"text":"Today, we've only got two."},"2208":{"dur":2,"text":"It really depends on how quickly\nwe can pull that data down,"},"2211":{"dur":3,"text":"suck it down from one\nbucket to another."},"2214":{"dur":2,"text":"So let's see what happens\nand see if we get any more."},"2223":{"dur":2,"text":"So now we've got four\nvirtual machines."},"2225":{"dur":2,"text":"So now, what we're going to\ndo is go back to the slides"},"2228":{"dur":3,"text":"and look at one I created\nearlier, in real just Julia"},"2232":{"dur":3,"text":"Child style, as\nJulia would tell me."},"2235":{"dur":6,"text":"And we have this\ngraph, which shows"},"2242":{"dur":4,"text":"you CPU utilization,\nthe blue bar,"},"2247":{"dur":1,"text":"against number of\nvirtual machines."},"2248":{"dur":1,"text":"And obviously, this\nwasn't for this one."},"2250":{"dur":1,"text":"This was a run I\ndid on Saturday."},"2251":{"dur":2,"text":"And you can see that as\nwe hit 30% threshold,"},"2254":{"dur":1,"text":"we spin up a new\nvirtual machine."},"2256":{"dur":2,"text":"We spin up more\nvirtual machines."},"2258":{"dur":2,"text":"The CPU utilizations come down."},"2260":{"dur":2,"text":"At some point, we say, we have\ntoo many virtual machines,"},"2263":{"dur":1,"text":"so we removed them."},"2264":{"dur":2,"text":"Obviously, you don't want that\nto keep happening bang, bang,"},"2266":{"dur":1,"text":"bang, bang, bang,\nbang, so you have"},"2268":{"dur":3,"text":"this cool down period\nwhere you can say,"},"2271":{"dur":4,"text":"there has to be a minimum of\nthis time between Auto Scale"},"2275":{"dur":2,"text":"activations, and\nthat's what happens."},"2278":{"dur":1,"text":"That's the demo."},"2279":{"dur":2,"text":"We'll come back to it\nlater if we have time."},"2281":{"dur":1,"text":"So I just wanted to\nshare a couple of tips"},"2283":{"dur":5,"text":"with you, as Wes did,\nwith measuring fast,"},"2288":{"dur":1,"text":"a few tips on scaling fast."},"2290":{"dur":2,"text":"The first one is always to use\nGoogle App Engine as the entry"},"2293":{"dur":3,"text":"point for your web applications\nand as the API service"},"2296":{"dur":4,"text":"for your mobile and\ngaming back ends."},"2300":{"dur":4,"text":"As we've seen with example\nof One Direction Day,"},"2305":{"dur":2,"text":"App Engine scales extremely\nwell and extremely quickly,"},"2307":{"dur":2,"text":"and there's very, very\nlittle work on your part"},"2309":{"dur":0,"text":"that you have to do."},"2310":{"dur":3,"text":"Now, some applications are\nbest suited for App Engine,"},"2313":{"dur":3,"text":"and in that case, you can\nbuild a modular application"},"2317":{"dur":2,"text":"where all of your front\nside stuff is on App Engine"},"2320":{"dur":4,"text":"but virtual machines being\nmanaged by App Engine"},"2324":{"dur":2,"text":"are running your back end code."},"2326":{"dur":3,"text":"That's really easy\nand simple to set up."},"2330":{"dur":1,"text":"Also, make use of edge caching."},"2331":{"dur":2,"text":"So we've seen that\nwith Andromeda, we"},"2334":{"dur":2,"text":"have much higher\nthroughput, particularly"},"2336":{"dur":2,"text":"on larger instances,\nbut throughput always"},"2338":{"dur":0,"text":"involves latency."},"2339":{"dur":3,"text":"So any kind of movement of\nstuff through the network"},"2343":{"dur":1,"text":"will involve latency."},"2344":{"dur":2,"text":"The best thing to do is\ncache your content as close"},"2346":{"dur":1,"text":"to the user as possible."},"2348":{"dur":2,"text":"And you can make use of edge\ncaching, which is caching it"},"2351":{"dur":2,"text":"in our data centers,\nor with ISPs,"},"2353":{"dur":2,"text":"because we have a global peering\nrelationship with many ISPs."},"2356":{"dur":5,"text":"And you can do this with App\nEngine using Static Content,"},"2362":{"dur":2,"text":"with Cloud Storage by\nsetting cache control"},"2364":{"dur":1,"text":"headers on any data you store."},"2365":{"dur":1,"text":"And with App Engine,\nagain, you can do it"},"2367":{"dur":3,"text":"on dynamically generated\ncontent by setting cache control"},"2371":{"dur":3,"text":"headers on the response stream."},"2374":{"dur":2,"text":"And very quickly, because\nwe're running out of time,"},"2376":{"dur":1,"text":"I'm going to run through\nthese very quick."},"2378":{"dur":1,"text":"For network I\/O\nintensive workloads,"},"2380":{"dur":2,"text":"make use of those big, virtual\nmachines for more network"},"2382":{"dur":2,"text":"throughput."},"2385":{"dur":2,"text":"For scaling, App\nEngine can sometimes"},"2387":{"dur":1,"text":"do with some help\nfor scaling, and you"},"2389":{"dur":1,"text":"can use idle instances\non App Engine"},"2391":{"dur":2,"text":"to make it scale that\nlittle bit better."},"2393":{"dur":2,"text":"Idle Instances effectively\nanswer requests"},"2395":{"dur":2,"text":"when there's no instance\navailable to actually answer"},"2398":{"dur":1,"text":"that request immediately."},"2399":{"dur":3,"text":"They're [INAUDIBLE] as a\nbackup to answer requests."},"2403":{"dur":2,"text":"And the final one\nis to take advantage"},"2405":{"dur":2,"text":"of features such as\nPage Speed and Memcache."},"2408":{"dur":3,"text":"Page Speed effectively is an\nApp Engine application or App"},"2411":{"dur":3,"text":"Engine service that's\nfree to anybody"},"2415":{"dur":2,"text":"who has a paid\napplication, a set billing"},"2417":{"dur":3,"text":"app on your application, and\nit will optimize your HTTP"},"2420":{"dur":2,"text":"request, it will\ncompress and cache data,"},"2423":{"dur":3,"text":"and it provides services such\nas in lining and critical path"},"2426":{"dur":0,"text":"Memcache."},"2427":{"dur":1,"text":"You guys all know\nhow to use Memcache,"},"2429":{"dur":2,"text":"but you can also take advantage\nof dedicated Memcache,"},"2432":{"dur":2,"text":"as we did with\nOne Direction Day."},"2439":{"dur":3,"text":"So we've seen that Google is\nbuilt on a culture of fast,"},"2442":{"dur":1,"text":"and that we're constantly\ndriving innovation"},"2444":{"dur":4,"text":"within our infrastructure in\norder to maintain and improve"},"2448":{"dur":4,"text":"performance across all\nof our APIs and services."},"2453":{"dur":2,"text":"We've also seen the Google\nCloud Platform benefits"},"2455":{"dur":8,"text":"from this innovation through\nnetwork stuff like Andromeda."},"2463":{"dur":4,"text":"We've also seen that long\ntail latency is an issue"},"2467":{"dur":1,"text":"and it can be addressed\nwith the ability"},"2469":{"dur":2,"text":"to measure fast,\nas Wes showed you."},"2471":{"dur":2,"text":"We looked at tools such\nas Cloud Trace that"},"2473":{"dur":2,"text":"allow you to actually gain\nrapid insight into issues"},"2476":{"dur":4,"text":"like [INAUDIBLE] running in\napplications in the cloud."},"2480":{"dur":2,"text":"And finally, fast matters."},"2483":{"dur":3,"text":"We come back to the message\nthat Wes had initially."},"2486":{"dur":0,"text":"Fast matters."},"2487":{"dur":3,"text":"Fast will always matter,\nand Google Cloud Platform"},"2490":{"dur":4,"text":"can help you build applications\nthat run fast in the cloud."},"2495":{"dur":2,"text":"So what are you going to build?"},"2497":{"dur":2,"text":"With that, we're\ngoing to sign off."},"2500":{"dur":3,"text":"We've only got a couple\nof minutes for questions."},"2503":{"dur":2,"text":"The call to action, go to\nthe Cloud Platform blog"},"2505":{"dur":2,"text":"and find out about features\nthat Wes talked about"},"2507":{"dur":1,"text":"and that I talked about."},"2509":{"dur":1,"text":"Preview features such\nas Deployment Manager"},"2511":{"dur":1,"text":"and Replica Pools."},"2512":{"dur":1,"text":"You can sign up there."},"2513":{"dur":2,"text":"The next session is\nin Room Seven, Zero"},"2516":{"dur":3,"text":"to Hero with Google Cloud\nPlatform with Chris Ramsdale."},"2519":{"dur":2,"text":"You can provide feedback\nvia the QR code."},"2522":{"dur":1,"text":"There's one up\nthere on the board."},"2526":{"dur":2,"text":"And you probably haven't\nreceived anything about this"},"2528":{"dur":2,"text":"yet, but you can get $500 in\ncredits for the Google Cloud"},"2531":{"dur":1,"text":"Platform."},"2533":{"dur":6,"text":"Go to g.co\/CloudStarterPack and\nenter the promo code GoogleIO."},"2539":{"dur":4,"text":"And there's also a road show\nin the US happening very soon,"},"2543":{"dur":2,"text":"and you can go to\ngooglecloudroadshow.com"},"2545":{"dur":1,"text":"to sign up for that."},"2546":{"dur":0,"text":"WESTON HUTCHINS: Great."},"2547":{"dur":1,"text":"If you guys have any\nquestions, Mandy and I"},"2549":{"dur":2,"text":"are going to be sitting outside\nin the cloud booth over there,"},"2552":{"dur":2,"text":"so come find us."},"2554":{"dur":1,"text":"Thank you very much."}}