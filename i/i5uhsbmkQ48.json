{"0":{"dur":2,"text":"COLT MCANLIS: In this episode\nof Cloud Performance Atlas,"},"2":{"dur":1,"text":"I help some leaping\nlizards track down"},"4":{"dur":2,"text":"why their bandwidth\nwas off in the weeds."},"6":{"dur":1,"text":"Will we catch\nwhat's bugging them?"},"8":{"dur":1,"text":"Stay tuned to find out."},"9":{"dur":2,"text":"[MUSIC PLAYING]"},"11":{"dur":3,"text":"I got a nice call from the Gecko\nProtocol team, a B2B company"},"15":{"dur":2,"text":"offering a custom, lightweight\nnetworking protocol, built"},"18":{"dur":2,"text":"for gaming and other\nreal-time graphics systems."},"20":{"dur":2,"text":"Their team was seeing lower\nthan expected throughput"},"22":{"dur":1,"text":"for their back-end\nmachines, which"},"24":{"dur":2,"text":"are responsible for\ntransferring and transcoding"},"26":{"dur":2,"text":"large video and graphics files."},"28":{"dur":2,"text":"Their architecture worked a\nlittle something like this."},"30":{"dur":2,"text":"A client will push about\ntwo terabytes of data"},"32":{"dur":1,"text":"to cloud storage."},"33":{"dur":1,"text":"At the same time, it\nkicks off work request"},"35":{"dur":3,"text":"to a front end, which leverages\na TCP load balancer to spin up"},"39":{"dur":2,"text":"a bunch of compute and engine\ninstances in a single region"},"42":{"dur":2,"text":"to feed on that data,\ntalk between each other,"},"44":{"dur":1,"text":"and get the work done."},"46":{"dur":1,"text":"Most of this was\nworking as expected."},"47":{"dur":1,"text":"However, the Gecko\nProtocol group"},"49":{"dur":2,"text":"was concerned about VM\nto VM throughput, where"},"51":{"dur":3,"text":"they were only seeing about\n1.5 gigabit per second max"},"55":{"dur":0,"text":"connections."},"56":{"dur":1,"text":"I duplicated their\nsetup on my side,"},"58":{"dur":2,"text":"which involved a bunch\nof one-CPU machines"},"60":{"dur":2,"text":"in a single region\nand ran iPerf on them."},"62":{"dur":1,"text":"The result was\nabout 1.95 gigabits"},"64":{"dur":1,"text":"per second, which was\nmuch higher than what"},"66":{"dur":1,"text":"Gecko Protocol was seeing."},"67":{"dur":2,"text":"Now, I knew from experience\nthat for high bandwidth systems,"},"70":{"dur":1,"text":"they were obviously\nusing too small a machine"},"72":{"dur":2,"text":"for those efforts, since\nnetworking throughput"},"74":{"dur":1,"text":"is related to core count."},"75":{"dur":3,"text":"Bumping it up to about 16 CPU\nmachines in the US central one"},"79":{"dur":3,"text":"region, I was able to\nget about 15.9 gigabits"},"82":{"dur":1,"text":"per second--\nobviously, much better."},"84":{"dur":2,"text":"However, when the Gecko\nProtocol team switched over"},"86":{"dur":2,"text":"to this configuration, they\ndidn't see the same results."},"89":{"dur":3,"text":"They only ended up at about\n1.6 gigabits per second."},"92":{"dur":1,"text":"After about 20 minutes\nof a video chat trying"},"94":{"dur":1,"text":"to get our\nconfigurations identical,"},"96":{"dur":1,"text":"the solution smacked\nus right in the face."},"98":{"dur":2,"text":"The problem was that their\nteam was testing the connection"},"100":{"dur":2,"text":"to the external\nIP of the server,"},"102":{"dur":2,"text":"while I was testing\non the internal IP."},"105":{"dur":1,"text":"See, if two machines\nare communicating"},"107":{"dur":1,"text":"using their internal\nIPs, then they"},"109":{"dur":2,"text":"can send traffic on\nGoogle's private internet,"},"111":{"dur":1,"text":"which is super fast."},"112":{"dur":2,"text":"Using the public IP, however,\nforces the data packet"},"115":{"dur":1,"text":"to get pushed to\nthe public internet"},"116":{"dur":2,"text":"before coming back to\nthe machine, a.k.a."},"119":{"dur":1,"text":"not the fastest."},"120":{"dur":1,"text":"When we switched over\ntheir configuration"},"121":{"dur":2,"text":"to use the internal IPs with\nthe larger machine setup,"},"124":{"dur":1,"text":"the bandwidth went\nthrough the roof--"},"126":{"dur":2,"text":"15.9 gigabits per second."},"128":{"dur":2,"text":"For Gecko Protocol, this\nsmall debugging session"},"130":{"dur":1,"text":"resulted in their\nvideo and graphics data"},"132":{"dur":2,"text":"transfer rate\nimproving by about 14x."},"135":{"dur":2,"text":"For more great Cloud content,\nsubscribe to the Google Cloud"},"137":{"dur":1,"text":"YouTube channel,\nand stay up to date"},"139":{"dur":2,"text":"with other Cloud Performance\nAtlas video content."},"142":{"dur":1,"text":"Because when it\ncomes to performance,"},"143":{"dur":1,"text":"every millisecond counts."},"144":{"dur":3,"text":"[MUSIC PLAYING]"}}